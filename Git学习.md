由于我只学习了Git的一部分，所以这里只记录我学习到的内容，后续再继续补充。

## Git命令

这里先列出一些常用的命令以供参考和查阅。

### 基本命令

| 命令 | 作用 |
| --- | --- |
| git init | 初始化一个Git仓库 |
| git add file | 将文件添加到暂存区 |
| git commit -m "message" | 将暂存区的文件提交到仓库 |
| git status | 查看仓库的状态 |
| git log | 查看提交历史 |

### 远程仓库

| 命令 | 作用 |
| --- | --- |
| git remote add repo_name repo_url | 添加远程仓库 |
| git push origin b1:b2 | 将本地仓库的b1分支推送到远程仓库的b2分支 |
| git pull origin b1:b2 | 从远程仓库b1分支拉取代码并合并到本地仓库b2分支 |

> `git pull == git fetch + git merge`


## 具体理解

### Git的提交
Git是一个数据库，它的基本单元是提交（commit）。每个提交对象中包含三个部分：指向**当前快照**的指针、指向父提交的指针和元数据（提交者、提交时间和提交信息等）。每个提交形成了一个链式结构，通过指针连接。

### 分支
分支是一个指针，指向某个提交对象。
创建分支时，Git会创建一个指针，指向当前提交。
合并分支时，Git会创建一个新的提交对象，该对象有两个父提交，分别是两个分支的最后一个提交。

### HEAD
HEAD是一个指针，指向当前所在位置。它可以指向某个分支（正常状态），也可以指向某个提交（称为“分离头指针”状态）。
> 处于分离头指针状态时，新的提交的父提交是HEAD指向的提交，此时不会有分支指针指向这个新提交，需要手动创建分支，否则这个提交可能会丢失。

### 三个区域
Git有三个区域：工作区、暂存区和仓库。
- 工作区：就是你的项目目录。
- 暂存区：是一个临时存储区域，用于存储即将提交的文件。
- 仓库：是Git的核心区域，存储了所有的提交对象。

### 对比：checkout VS reset VS revert

#### checkout
checkout命令用于移动HEAD指针，可以移动到某个分支或者某个提交。工作区和暂存区的内容会被更新。因此，如果工作区或暂存区存在未提交的改动，切换将会失败，此时有两种选择，一是先提交改动，二是使用`-f`参数强制切换。

#### reset
这个命令的核心是回退，撤销某个提交，它会同时移动HEAD和当前分支指针。
`--soft`：仅仅将仓库重置为某一次提交的版本（将分支指针指向该commit），在这一次提交后所有的修改都会变成未提交的状态。
`--mixed`：将仓库和暂存区同时重置为该提交的版本，工作区不变，因此可能会产生很多没有add的文件，但不存在未提交的文件。
`--hard`：将仓库、暂存区和工作区都回退到某个提交的版本。

> --hard选项会丢失所有未提交的改动，因此需要谨慎使用。不小心误用后，可以使用`git reflog`查看历史记录，找到误操作前的提交，然后使用`git reset --hard <commit_id>`恢复。

#### revert
这个命令的核心是补偿。它通过创建一个新的提交来实现撤销，这个新提交的内容正好与你要撤销的提交相反。这样做的好处是：它不会改变现有的提交历史，只是增加了一次提交。因此，它是唯一一个可以安全地用于撤销已经推送到远程仓库的提交的命令。当需要撤销一个合并提交（merge commit）时，还需要使用`-m`选项来指定要保留的主线。

### 对比：rebase VS merge

#### rebase
rebase命令用于将一个分支的提交应用到另一个分支上，它会创建一个新的提交，这个提交的内容与原提交相同，但父提交是目标分支的最后一个提交。rebase的好处是：它可以使提交历史更加清晰，但可能会打乱提交的顺序。
<br>
下面是一个示例：在dev分支上rebase master分支。
这是rebase前的提交历史：
<img src="./images/git-learn/rebase_before.png" alt="rebase前" width="80%" height="80%">
这是rebase后的提交历史：
<img src="./images/git-learn/rebase_after.png" alt="rebase后" width="80%" height="80%">

> rebase前后dev指向的提交对象并不是同一个对象

#### merge
merge命令用于将两个分支的提交合并到一起，它会创建一个新的合并提交，这个提交有两个父提交，分别是两个分支的最后一个提交。

> merge操作一般在master分支上进行（git merge dev）
> rebase操作一般在dev分支进行（git rebase master）